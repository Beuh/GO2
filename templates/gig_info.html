{% extends 'go2base.html' %}

{% block content %}
    {% set the_band_key = gig.key.parent() %}


    <div class="row">
        <div class="col-md-4 col-md-offset-2"><h1>Gig Info</h1></div>
    </div>
    <div class="row">
        <div class="col-md-4 col-md-offset-2">
            <a class="btn btn-primary btn-sm" href="gig_edit.html?gk={{ gig.key.urlsafe() }}">Edit</a>
        </div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-md-2 col-md-offset-2">Gig</div>
        <div class="col-md-8">{{ gig.title|e }}</div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-md-2 col-md-offset-2">Band</div>
        <div class="col-md-8"><a href="band_info.html?bk={{the_band_key.urlsafe()}}">{{ the_band_key.get().name|e }}</a></div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-md-2 col-md-offset-2">Date</div>
        <div class="col-md-8">{{ gig.date.strftime('%-m/%-d/%Y')|e }}</div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-md-2 col-md-offset-2">Details</div>
        <div class="col-md-8">{{ gig.details|e }}</div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-md-2 col-md-offset-2">Setlist <a href="print_setlist?gk={{gig.key.urlsafe()}}"><i class="icon-print"></i></a></div>
        <div class="col-md-8">{{ gig.setlist|e|replace("\n","<br>")}}</div>
    </div>
    <div class="row">&nbsp;</div>
    <div class="row">
        <div class="col-md-8 col-md-offset-2">
            <table class="table table-striped">
            {% import 'plan_edit.html' as plan_edit with context %}                
            {% for the_section in the_section_keys %}
            <tr>
                <td>
                    {% if the_section %}
                        {{the_section.get().name}}
                    {% else %}
                        No Section
                    {% endif %}
                </td>
                <td>
                    <table class="table">
                        {% for member_plan in the_plans %}
                            {% if member_plan['the_plan_key'].get().section == the_section %}
                                {{ plan_edit.plan_edit(member_plan, show_date=False, show_member=True, show_band=False, show_gig_name=False, show_section=True) }}
                            {% endif %}
                        {% endfor %}
                    </table>
                </td>
            </tr>
            {% endfor %}
            </table>
        </div>
    </div>
{% endblock content %}

{% block localscripts %}
<script src="/js/plan_buttons.js"></script>
{% endblock localscripts %}

